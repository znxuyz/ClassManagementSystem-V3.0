# 🌟 Class Scoreboard (班級記分板) — Google Sheets 版

一個專為 **班級經營與教學互動** 打造的前端應用程式，現在支援 **Google Sheets 雲端儲存** 🎉  
無需後端伺服器，直接部署到 **Google Apps Script**，就能在任何裝置上登入使用。  
支援 **學生端** 與 **教師端** 雙角色，結合 **多班級管理、排行榜、獎勵兌換、即時搶分活動** 等功能，幫助老師提升課堂參與度 🏫✨  

---

## ⚡ 新版特色
- ✅ **雲端資料儲存**：所有資料會自動寫入 Google Sheets，可跨裝置同步，不怕清除瀏覽器就消失  
- ✅ **完整功能保留**：延續原本的 UI 與操作邏輯（排行榜、公告、留言、獎品、搶分活動等）  
- ✅ **部署更簡單**：只需一個 Apps Script 專案，前後端整合完成 🪄  
- ✅ **教學更安心**：資料集中管理，方便備份與查詢  

---

## 🆕 更新紀錄 (Update Log)

### 🔥 近期更新
v3.1更新
- ✨ **增量寫入**：只更新異動的資料，不會整張表重寫  
- ⚡ **快取機制**：讀取結果快取 60 秒，降低 Google API 負擔  
- 📝 **錯誤紀錄**：所有錯誤會寫入 `Logs` 分表，方便除錯  
- 📊 **表格容量管理**：  
  - `ScoreHistory` 最多保留 10,000 筆  
  - `QuizAnswers` 最多保留 5,000 筆  
- 🗑 **刪除同步**：  
  - 刪除學生 / 獎品 / 公告 / 小組 → 立即刪除 Google Sheet 對應列  
  - 刪除小組會同時刪除該組學生  
- 🔄 **自動備份**：每 5 分鐘自動將資料上傳到 Google Sheets  
- ✅ **Toast 提示**：成功綠色，失敗紅色  

---

## 🔧 使用方式
1. 建立一份 **Google Sheet**（建議命名為 `Class Scoreboard`） 📑  
2. 在該試算表中，點擊 **擴充功能 → Apps Script**，開啟並建立一個專案 ✨  
3. 在左側找到預設的 `.gs` 檔案，將本專案中的 **Code.gs** 程式碼貼上並存檔  
4. 點擊左側的 **+** 新增檔案 → 選擇 **HTML**，命名為 `index`，將 **index.html** 貼上並存檔 🎨  
5. 回到 `Code.gs` → 按下執行 ▶️（會要求授權，依指示允許）  
6. 點擊右上角 **部署 → 新部署**，選擇「網頁應用程式」，權限設為「任何知道連結的人」 🔗  
7. 複製部署後的網址，就能和學生分享啦 🎉  

---

## 🚀 功能特色

### 🎓 學生端  
- 🏆 查看 **個人排行榜** 與 **小組排行榜**  
- 📢 即時接收 **課程公告**  
- 💬 發送與查看 **留言板**  
- 🎁 使用積分 **兌換獎品**  
- ⚡ 參與 **搶分活動 / 測驗**  

---

### 👩‍🏫 教師端  
- 🔐 登入保護（預設密碼 `hres`，錯誤 3 次鎖定 10 分鐘，可自行修改密碼）  
- 👥 管理 **學生與小組**  
- 📢 發布 **公告與留言**  
- 🎁 建立與管理 **獎品項目**  
- ✅ 審核學生 **兌換申請**  
- ⚡ 發布與管理 **搶分活動 / 測驗**  
- 📊 檢視 **分數歷程**  
- ✏️ 編輯 **班級標題**  

---

## 🖥 技術架構
- **前端技術**：HTML + CSS (Tailwind) + JavaScript  
- **資料儲存**：`Google Sheets`（雲端，跨裝置可同步存取）  
- **UI 風格**：玻璃質感卡片 ✨、圓角設計 🎨、懸浮按鈕 🪄  

---

## 🌟 適用情境
- 🏫 課堂活動積分管理  
- 🤝 小組合作競賽  
- ⚡ 課後測驗搶分  

---

## 📊 優缺點比較

### ✅ 優點
- ☁️ **雲端同步**：所有裝置資料一致，不怕換電腦或清除瀏覽器資料  
- 🔒 **更安全**：資料存在 Google Sheets，老師能直接備份與管理  
- 🌍 **隨時隨地使用**：只要有網頁瀏覽器就能操作，不受限於單一電腦  
- 🔧 **前後端一體化**：整合在 Apps Script，部署簡單  
- 💡 **UI/功能完整保留**：與舊版操作方式完全相同，學生/老師不用重新學習  

---

### ⚠️ 缺點
- 🚀 **速度依網路而定**：需要讀寫 Google Sheets，速度可能比 localStorage 慢  
- 📶 **需網路連線**：離線時無法使用  
- 📂 **Google 帳號綁定**：需 Google 帳號與 Sheets 權限，無法完全獨立使用  
- 🔧 **維護需求**：若 Google Sheets 結構被更動（刪欄、改名），可能導致程式錯誤  

---

## ⚠️ 注意事項
- 必須 **從 Google Sheet 開啟 Apps Script 專案**，程式才能正確存取與儲存資料  
- 如果直接從 [script.google.com](https://script.google.com) 新建專案，`SpreadsheetApp.getActiveSpreadsheet()` 會抓不到試算表，導致資料無法保存  
- 建議每個班級使用一份獨立的試算表，方便管理與避免超出單一表格容量  
